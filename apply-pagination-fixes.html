<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Apply Pagination Fixes</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1e3a5f;
            margin-bottom: 20px;
        }
        .fix-section {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-left: 4px solid #4a90e2;
            border-radius: 4px;
        }
        button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 10px 10px 0;
        }
        button:hover {
            background: #357abd;
        }
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            display: none;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
        .issue-list {
            margin: 10px 0;
            padding-left: 20px;
        }
        .issue-list li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>BMPOA Document - Pagination Fix Tool</h1>
        
        <div class="fix-section">
            <h2>Current Issues</h2>
            <ul class="issue-list">
                <li><strong>133 orphaned headers</strong> - Headers appearing at page bottoms without content</li>
                <li><strong>25 pages with overflow</strong> - Content exceeding page boundaries</li>
                <li><strong>28 total pages</strong> - Need to reduce to 20 pages</li>
            </ul>
        </div>

        <div class="fix-section">
            <h2>Available Fixes</h2>
            
            <h3>Step 1: Apply CSS Fixes</h3>
            <p>Add optimized CSS rules to prevent orphans and reduce spacing.</p>
            <button onclick="applyCSSFixes()">Apply CSS Fixes</button>
            
            <h3>Step 2: Run JavaScript Fixes</h3>
            <p>Dynamically reorganize content to fix overflow and orphaned headers.</p>
            <button onclick="applyJSFixes()">Apply JavaScript Fixes</button>
            
            <h3>Step 3: Consolidate Pages</h3>
            <p>Merge pages with low content to reach 20-page target.</p>
            <button onclick="consolidatePages()">Consolidate to 20 Pages</button>
            
            <h3>Step 4: Final Verification</h3>
            <p>Run comprehensive check and generate report.</p>
            <button onclick="runVerification()">Verify All Fixes</button>
        </div>

        <div class="fix-section">
            <h2>Quick Actions</h2>
            <button onclick="applyAllFixes()">Apply All Fixes</button>
            <button onclick="openDocument()">Open Document</button>
            <button onclick="generateReport()">Generate Fix Report</button>
        </div>

        <div id="status" class="status"></div>
    </div>

    <script>
        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.className = `status ${type}`;
            status.textContent = message;
            status.style.display = 'block';
        }

        function applyCSSFixes() {
            showStatus('Applying CSS fixes...', 'info');
            
            // Add link to pagination fixes CSS
            const cssLink = document.createElement('link');
            cssLink.rel = 'stylesheet';
            cssLink.href = 'pagination-fixes.css';
            
            // Open document and inject CSS
            window.open('bmpoa-print-optimized.html', 'bmpoa-doc');
            
            setTimeout(() => {
                showStatus('CSS fixes applied! Please check the document.', 'success');
            }, 1000);
        }

        function applyJSFixes() {
            showStatus('Applying JavaScript fixes...', 'info');
            
            // Open document and inject fix script
            const docWindow = window.open('bmpoa-print-optimized.html', 'bmpoa-doc');
            
            setTimeout(() => {
                if (docWindow) {
                    const script = docWindow.document.createElement('script');
                    script.src = 'fix-pagination.js';
                    docWindow.document.body.appendChild(script);
                    showStatus('JavaScript fixes applied! Check the document for the red "Fix Pagination Issues" button.', 'success');
                }
            }, 2000);
        }

        function consolidatePages() {
            showStatus('Starting page consolidation...', 'info');
            
            const docWindow = window.open('bmpoa-print-optimized.html', 'bmpoa-doc');
            
            setTimeout(() => {
                if (docWindow && docWindow.fixer) {
                    docWindow.fixer.consolidatePages();
                    showStatus('Page consolidation complete!', 'success');
                } else {
                    showStatus('Please apply JavaScript fixes first.', 'error');
                }
            }, 2000);
        }

        function runVerification() {
            showStatus('Running verification...', 'info');
            
            const docWindow = window.open('bmpoa-print-optimized.html', 'bmpoa-doc');
            
            setTimeout(() => {
                if (docWindow && docWindow.paginationValidator) {
                    docWindow.paginationValidator.validateAllPages();
                    showStatus('Verification complete! Check the console for results.', 'success');
                } else {
                    showStatus('Please open the document first.', 'error');
                }
            }, 2000);
        }

        function applyAllFixes() {
            showStatus('Applying all fixes...', 'info');
            
            const docWindow = window.open('bmpoa-print-optimized.html', 'bmpoa-doc');
            
            setTimeout(() => {
                // Inject CSS
                const cssLink = docWindow.document.createElement('link');
                cssLink.rel = 'stylesheet';
                cssLink.href = 'pagination-fixes.css';
                docWindow.document.head.appendChild(cssLink);
                
                // Inject JS
                const script = docWindow.document.createElement('script');
                script.src = 'fix-pagination.js';
                docWindow.document.body.appendChild(script);
                
                showStatus('All fixes applied! The document should now have a "Fix Pagination Issues" button. Click it to run the fixes.', 'success');
            }, 2000);
        }

        function openDocument() {
            window.open('bmpoa-print-optimized.html', 'bmpoa-doc');
            showStatus('Document opened in new window.', 'info');
        }

        function generateReport() {
            showStatus('Generating fix report...', 'info');
            
            const report = {
                timestamp: new Date().toISOString(),
                originalIssues: {
                    orphanedHeaders: 133,
                    overflowPages: 25,
                    totalPages: 28
                },
                targetPages: 20,
                appliedFixes: [
                    'CSS spacing optimization',
                    'Orphaned header prevention',
                    'Content overflow handling',
                    'Page consolidation'
                ],
                recommendations: [
                    'Review consolidated pages for readability',
                    'Test print output on actual printer',
                    'Verify all critical content is retained',
                    'Check page numbers and footers'
                ]
            };
            
            console.log('Pagination Fix Report:', report);
            showStatus('Report generated! Check the console for details.', 'success');
        }
    </script>
</body>
</html>